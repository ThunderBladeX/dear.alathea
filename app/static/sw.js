const CACHE_NAME='cottagecore-portfolio-v1';const CACHE_URLS=['/','/static/css/main.css','/static/js/main.js',];self.addEventListener('install',(event)=>{console.log('Service Worker installing...');event.waitUntil(caches.open(CACHE_NAME).then((cache)=>{console.log('Caching static assets');return cache.addAll(CACHE_URLS)}).catch((error)=>{console.error('Failed to cache assets:',error)}));self.skipWaiting()});self.addEventListener('activate',(event)=>{console.log('Service Worker activating...');event.waitUntil(caches.keys().then((cacheNames)=>{return Promise.all(cacheNames.map((cacheName)=>{if(cacheName!==CACHE_NAME){console.log('Deleting old cache:',cacheName);return caches.delete(cacheName)}}))}));self.clients.claim()});self.addEventListener('fetch',(event)=>{if(event.request.method!=='GET'){return}
event.respondWith(caches.match(event.request).then((response)=>{if(response){return response}
return fetch(event.request).then((response)=>{if(!response||response.status!==200||response.type!=='basic'){return response}
const responseToCache=response.clone();if(event.request.url.includes('/static/')||event.request.url.match(/\.(css|js|png|jpg|jpeg|gif|svg|webp|ico)$/)){caches.open(CACHE_NAME).then((cache)=>{cache.put(event.request,responseToCache)})}
return response}).catch((error)=>{console.error('Fetch failed:',error);throw error})}))});self.addEventListener('message',(event)=>{if(event.data&&event.data.type==='SKIP_WAITING'){self.skipWaiting()}});self.addEventListener('sync',(event)=>{if(event.tag==='background-sync'){console.log('Background sync triggered')}});self.addEventListener('push',(event)=>{if(event.data){const data=event.data.json();const options={body:data.body,icon:'/static/images/icon-192x192.png',badge:'/static/images/badge-72x72.png',vibrate:[200,100,200],data:data.data||{}};event.waitUntil(self.registration.showNotification(data.title,options))}});self.addEventListener('notificationclick',(event)=>{event.notification.close();event.waitUntil(clients.openWindow(event.notification.data.url||'/'))})
